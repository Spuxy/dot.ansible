- name: "ðŸŽµ Pipewire"
  block:
    - name: "ðŸŽµ installation sounds pkgs"
      community.general.pacman:
        name:
          [
            "pipewire",
            "pipewire-pulse",
            "pipewire-audio",
            "pipewire-alsa",
            "wireplumber",
            "pavucontrol",
            "pamixer",
          ]
        state: present
      become: true
      become_user: "root"
      become_method: "sudo"

- name: "ðŸŽµ enable systemd pipewire.socket"
  ansible.builtin.systemd_service:
    name: "pipewire.socket"
    state: started
    enabled: true
    scope: user
  become: true
  become_user: "{{ ansible_user }}"

- name: "ðŸŽµ enable systemd pipewire-pulse.service"
  ansible.builtin.systemd_service:
    name: "pipewire-pulse.service"
    enabled: true
    scope: user
  become: true
  become_user: "{{ ansible_user }}"

- name: "ðŸŽµ enable systemd pipewire-pulse.socket"
  ansible.builtin.systemd_service:
    name: "pipewire-pulse.socket"
    enabled: true
    scope: user
  become: true
  become_user: "{{ ansible_user }}"

- name: "ðŸŽµ enable systemd wireplumber.service"
  ansible.builtin.systemd_service:
    name: "wireplumber.service"
    enabled: true
    scope: user
  become: true
  become_user: "{{ ansible_user }}"

- name: "ðŸŽµ enable systemd pipewire.service"
  ansible.builtin.systemd_service:
    name: "pipewire.service"
    enabled: true
    scope: user
  become: true
  become_user: "{{ ansible_user }}"

- name: "ðŸŽµ To be sure that pulse is deleted"
  community.general.pacman:
    name:
      [
        "pulseaudio",
        "pulseaudio-bluetooth",
        "pulseaudio-alsa",
      ]
    state: absent
  become: true
  become_user: "root"
  become_method: "sudo"

- name: "ðŸŽµ disable systemd pulseaudio.service"
  ansible.builtin.systemd_service:
    name: "pulseaudio.service"
    enabled: false
    scope: user
  become: true
  become_user: "{{ ansible_user }}"

- name: "ðŸŽµ disable systemd pulseaudio.socket"
  ansible.builtin.systemd_service:
    name: "pulseaudio.socket"
    enabled: false
    scope: user
  become: true
  become_user: "{{ ansible_user }}"
