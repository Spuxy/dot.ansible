- name: "spotify"
  block:
    - name: "ğŸ“¦ installing a packages"
      community.general.pacman:
        name:
          - "spotify"
          - "spotifyd"
        state: present
      become: true
      become_user: "root"
      become_method: "sudo"

    - name: âœ… check if spotify-tui bin exists
      stat:
        path: "/usr/bin/spt"
      register: spt_bin

    - name: "ğŸ“¦ installing an package"
      shell:
        cmd: "yay -S --answerclean Y --answerdiff N --noconfirm --noprogressbar spotify-tui"
      become: true
      become_user: "{{ ansible_user }}"
      when: not spt_bin.stat.exists

    - name: "ğŸ–¨ï¸ copying a dotfiles"
      shell: "stow -d {{ ansible_dotfiles }} -S spotifyd"

    - name: "ğŸš¨ enable systemd spotifyd.service"
      ansible.builtin.systemd_service:
        name: "spotifyd.service"
        state: started
        enabled: true
        scope: user
      become: true
      become_user: "{{ ansible_user }}"

